void 0===window.nini&&(window.nini={}),window.nini.editorEnv={mode:null,parent:null,windowRef:null,app:null},window.nini.canvas=(()=>{var i,o,c={grid:{display:!1},render:function(e,t){if((i=$(e)).getContext){(o=i.getContext("2d")).reset();for(var n=t.sort(function(e,t){return e.order-t.order}),r=0;r<n.length;r++)n[r].op(i,o);c.drawGrid(i,o)}},drawGrid:function(e,t){if(c.grid.display){var n=e.size.width,r=e.size.height,i=Math.floor(n/10),o=Math.floor(r/10);t.beginPath(),t.fillStyle="rgba(0,0,0,0.5)",t.fillRect(0,0,n,r),t.closePath(),t.beginPath(),t.lineWidth=2;for(var a=0;a<=n;a+=i)t.moveTo(a,0),t.lineTo(a,r);t.strokeStyle="gray",t.stroke(),t.closePath(),t.beginPath(),t.lineWidth=2;for(var d,s,a=0;a<=r;a+=o)t.moveTo(0,1+a),t.lineTo(n,1+a);t.strokeStyle="gray",t.stroke(),t.closePath(),t.font="bold 14px Arial",t.fillStyle="white";t.beginPath(),t.textAlign="start",t.textBaseline="top",d=Math.floor(n/2),s=Math.floor(r/2),t.fillText("[0, 0]",d+4,s+4),t.closePath(),t.beginPath(),t.textAlign="start",t.textBaseline="top",d=-1*Math.floor(n/2),s=Math.floor(r/2),t.fillText("["+d+", "+s+"]",4,4),t.closePath(),t.beginPath(),t.textAlign="end",t.textBaseline="top",d=Math.floor(n/2),s=Math.floor(r/2),t.fillText("["+d+", "+s+"]",n-4,4),t.closePath(),t.beginPath(),t.textAlign="start",t.textBaseline="bottom",d=-1*Math.floor(n/2),s=-1*Math.floor(r/2),t.fillText("["+d+", "+s+"]",4,r-4),t.closePath(),t.beginPath(),t.textAlign="end",t.textBaseline="bottom",d=Math.floor(n/2),s=-1*Math.floor(r/2),t.fillText("["+d+", "+s+"]",n-4,r-4),t.closePath(),t.beginPath(),t.textAlign="start",t.textBaseline="top",t.fillStyle="yellow",d=e.currentCentre.x-e.trueCentre.x,s=negateNum(e.currentCentre.y-e.trueCentre.y),t.fillText("["+d+", "+s+"]",e.currentCentre.x+4,e.currentCentre.y+4),t.arc(e.currentCentre.x,e.currentCentre.y,4,0,2*Math.PI),t.fill(),t.closePath()}},reset:function(){o&&o.reset()}};return c})(),window.nini.compiler=function(){var compiler={op:[],reset:function(){compiler.op=[]},parse:function(e){for(var t,n=e.split(/\n/),r=[],i=0;i<n.length;i++)0===(t=n[i].trim()).length||/^\s*$/.test(t)||/^\/\/\s*(.*)$/.test(t)||(-1===t.indexOf("sign")&&(t=t.toLowerCase()),r.push(t));return r},compile:function(source){if(void 0!==source&&0!==source.length){var parsed=compiler.parse(source);if(void 0!==parsed&&0!==parsed.length){for(var inst=window.nini.inst,instLength=inst.length,order_op=0,rotation=void 0,lineMatched,repeat_count=null,loc=0;loc<getLengthOfParsedLines();loc++){var line=parsed[loc];if(""!==line&&0!==line.length){for(var lineMatched=!1,varNames=Object.keys(window.nini.vars),n=0;n<varNames.length;n++){var varName=varNames[n],varData=window.nini.vars[varName],checkRegex=new RegExp("^data\\s+\\"+varName+".*$");-1===line.indexOf(varName)||checkRegex.test(line)||(parsed[loc]=line=line.replaceAll(varName,varData))}if(null!==repeat_count&&"number"==typeof repeat_count&&0<=repeat_count){for(var parsedLeft=parsed.slice(0,loc-1),parsedRight=parsed.slice(loc+1,parsed.length),loc=parsedLeft.length-1,i=0;i<repeat_count;i++){var newLine=line.replaceAll("#",i+1);parsedLeft.push(newLine)}for(var n=0;n<parsedRight.length;n++)parsedLeft.push(parsedRight[n]);parsed=parsedLeft,parsedRight=null,repeat_count=null,loc++,line=parsed[loc]}for(var calcRegExp=/calc\((.*)\)/,lineSplitted=line.split(","),l=0;l<lineSplitted.length;l++)for(var lineSection=lineSplitted[l];-1!==lineSection.search(calcRegExp);){var calc=lineSection.match(calcRegExp);calc[1]=calc[1].replace("--","-"),calc[1]=calc[1].replace("\\+\\+","+"),lineSplitted[l]=lineSection=lineSection.replace(calcRegExp,Math.floor(eval(calc[1])))}1<lineSplitted.length?parsed[loc]=line=lineSplitted.join(","):parsed[loc]=line=lineSplitted[0];for(var ic=0,syntaxErrorMessage;ic<instLength&&!lineMatched;ic++){var name=inst[ic][0],pattern=inst[ic][1].pattern,parseInst=inst[ic][1].parse,customOrder=inst[ic][1].order,result=line.match(pattern),extra={order:order_op,rotation:rotation};if(result&&result[1])switch(lineMatched=!0,name){case"change_order":order_op=parseInst(result);break;case"change_rotation":rotation=parseInst(result);break;case"repeat_num":repeat_count=parseInst(result);break;default:compiler.op.push({order:void 0!==customOrder?customOrder:order_op,op:parseInst(result,extra),name:name,line:line})}}lineMatched||(syntaxErrorMessage="Syntax Error on line "+loc+1,syntaxErrorMessage+='\nInvalid Instruction: "'+line+'"',console.log(syntaxErrorMessage))}}console.log("Instructions:",compiler.op)}}function getLengthOfParsedLines(){return parsed.length}}};return compiler}();{function $(e){e=document.getElementById(e);return e.addClass=addClass,e}function addClass(e){this.classList.add(e)}}function negateNum(e){return 0===e?0:e<0?Math.abs(e):-1*Math.abs(e)}function calcTwoPointDistance(e,t,n,r){e-=n,n=t-r;return Math.sqrt(e*e+n*n)}function degreesToRadians(e){return e*(Math.PI/180)}function radiansToDegrees(e){return e*(180/Math.PI)}function createDownload(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function createPopUp(e,t,n){n="left="+n.left+",top="+n.top+",width="+n.width+",height="+n.height+",status=yes,toolbar=no,menubar=no";window.open(e,t,n)||alert("Pop-up window was blocked by your browser.")}function createCornerVars(e,t,n,r){for(var i=-1*(n/2+e),o=r/2+t,a=[i,o],d=negateNum(e),s=r/2+t,c=[d,s],l=n/2+negateNum(e),u=r/2+t,p=[l,u],h=-1*(n/2+e),w=-1*(r/2+negateNum(t)),g=[h,w],_=negateNum(e),f=-1*(r/2+negateNum(t)),b=[_,f],m=n/2+negateNum(e),r=-1*(r/2+negateNum(t)),v=[m,r],y=-1*(n/2+e),x=t,$=[y,x],n=n/2+negateNum(e),e=[n,t],N=[["$tlx",i],["$tly",o],["$tcx",d],["$tcy",s],["$trx",l],["$try",u],["$blx",h],["$bly",w],["$bcx",_],["$bcy",f],["$brx",m],["$bry",r],["$lcx",y],["$lcy",x],["$rcx",n],["$rcy",t]],C=0;C<N.length;C++){var k=N[C];window.nini.vars[k[0]]=k[1]}for(var P=[["$tl",a],["$tc",c],["$tr",p],["$bl",g],["$bc",b],["$br",v],["$lc",$],["$rc",e]],S=0;S<P.length;S++){k=P[S];window.nini.vars[k[0]]="["+k[1][0]+","+k[1][1]+"]"}}function createLine(e,t,n,r,i,o,a,d){d.niniSkipDraw&&!fill||(isNaN(o)&&(o=0),void 0===i&&(i=calcTwoPointDistance(e,t,n,r)),o=degreesToRadians(o),void 0!==n&&void 0!==r||(n=e+i,r=t),t=negateNum(t),r=negateNum(r),d.save(),d.translate(a.currentCentre.x+e,a.currentCentre.y+t),d.rotate(o),d.beginPath(),d.moveTo(0,0),d.lineTo(n-e,r-t),d.stroke(),d.closePath(),d.restore())}function draw_line_coord_coord_deg(e,t,n,r){t=e[5]?Number(e[5]):Number(t.rotation);createLine(Number(e[1]),Number(e[2]),Number(e[3]),Number(e[4]),void 0,t,n,r)}function draw_line_coord_length_deg(e,t,n,r){var i=Number(e[3]),t=e[4]?Number(e[4]):Number(t.rotation);createLine(Number(e[1]),Number(e[2]),void 0,void 0,i,t,n,r)}function createRect(e,t,n,r,i,o,a,d){var s,c;d.niniSkipDraw&&!o||(isNaN(i)&&(i=0),s=Math.round(n/2),c=Math.round(r/2),t=negateNum(t),i=degreesToRadians(i),d.save(),d.beginPath(),d.translate(a.currentCentre.x+e,a.currentCentre.y+t),d.rotate(i),o?d.fillRect(negateNum(s),negateNum(c),n,r):d.strokeRect(negateNum(s),negateNum(c),n,r),d.closePath(),d.restore())}function create_rect_coord_width_height_deg(e,t,n,r,i){t=e[5]?Number(e[5]):Number(t.rotation);createRect(Number(e[1]),Number(e[2]),Number(e[3]),Number(e[4]),t,i,n,r)}function createArc(e,t,n,r,i,o,a,d){d.niniSkipDraw&&!o||(t=negateNum(t),d.save(),d.beginPath(),d.translate(a.currentCentre.x+e,a.currentCentre.y+t),d.arc(0,0,n,r,i),o?d.fill():d.stroke(),d.closePath(),d.restore())}function create_circle_coord_radius(e,t,n,r,i){createArc(Number(e[1]),Number(e[2]),Number(e[3]),0,2*Math.PI,i,n,r)}function createEllipse(e,t,n,r,i,o,a,d,s,c,l){l.niniSkipDraw&&!s||(isNaN(i)&&(i=0),t=negateNum(t),l.save(),l.beginPath(),l.translate(c.currentCentre.x+e,c.currentCentre.y+t),l.ellipse(0,0,n,r,i,o,a,d),s?l.fill():l.stroke(),l.closePath(),l.restore())}function create_arc_coord_radius_angles(e,t,n,r,i){var o=Number(e[1]),a=Number(e[2]),d=Number(e[3]),s=Number(e[4]),c=Number(e[5]),l=Number(e[6]);createEllipse(o,a,d,s,degreesToRadians(e[7]?Number(e[7]):Number(t.rotation)),2*Math.PI*(c/100),2*Math.PI*(l/100),!1,i,n,r)}function createTriangle(e,t,n,r,i,o){var a,d,s,c,l,u;o.niniSkipDraw&&!r||(a=e[0],d=e[2],c=e[3],s=e[4],l=e[5],e=negateNum(e=e[1]),c=negateNum(c),l=negateNum(l),u=t[0],t=negateNum(t[1]),o.save(),o.beginPath(),o.translate(i.currentCentre.x+u,i.currentCentre.y+t),o.rotate(n),o.moveTo(a,e),o.lineTo(d,c),o.lineTo(s,l),o.lineTo(a,e),r?o.fill():o.stroke(),o.closePath(),o.restore())}function create_triangle_coord_base_height_deg(e,t,n,r,i){var o=Number(e[1]),a=Number(e[2]),d=Number(e[3]),s=o,c=a,l=o+d,u=a,o=o+d/2,d=a+Number(e[4]),a=(s+l+o)/3,p=(c+u+d)/3,h=[s,c];createTriangle([s-=a,c-=p,l-=a,u-=p,o-=a,d-=p],h,degreesToRadians(e[5]?Number(e[5]):Number(t.rotation)),i,n,r)}function create_triangle_coord_coord_coord_deg(e,t,n,r,i){var o=Number(e[1]),a=Number(e[2]),d=Number(e[3]),s=Number(e[4]),c=Number(e[5]),l=Number(e[6]),u=(o+d+c)/3,p=(a+s+l)/3;createTriangle([o-=u,a-=p,d-=u,s-=p,c-=u,l-=p],[u,p],degreesToRadians(e[7]?Number(e[7]):Number(t.rotation)),i,n,r)}function setCode(e){window.nini.app.compilerRun(e)}function getCode(){return window.tempStorage.getValue("code")||""}function toggleGrid(){window.nini.app.toggleGrid()}function displayGridValue(){return window.nini.canvas.grid.display}void 0===window.tempStorage&&(window.tempStorage=(()=>{var i={store:{},loadData:function(e){for(var t,n=decodeURIComponent(e).split(";"),r=0;r<n.length;r++)t=n[r].split("="),i.store[t[0]]=t[1]},setValue:function(e,t){document.cookie=e+"="+encodeURIComponent(t)+";",i.store[e]=t},getValue:function(e){if(void 0!==i.store[e])return i.store[e]}};return i})()),window.nini.inst=[],window.nini.vars={},window.nini.inst.push(["double_slash_comment",{pattern:/^\/\/\s*(.*)$/,parse:function(){return function(){return null}}}]),window.nini.inst.push(["change_order",{pattern:/^-\s?order\s+(-?\d{1,4})$/,parse:function(e,t){return Number(e[1])}}]),window.nini.inst.push(["change_rotation",{pattern:/^-\s?rotate\s+(-?\d{1,4})$/,parse:function(e,t){return Number(e[1])}}]),window.nini.inst.push(["repeat_num",{pattern:/^repeat\s+(\d{1,4})$/,parse:function(e,t){return Number(e[1])}}]),window.nini.inst.push(["centre_list",{pattern:/^-\s+center\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]$/,parse:function(e,t){var i=Number(e[1]),o=negateNum(Number(e[2]));return createCornerVars(i,o,window.nini.vars.$pw,window.nini.vars.$ph),function(e,t){var n=e.trueCentre.x+i,r=e.trueCentre.y+o;e.currentCentre={x:n,y:r}}}}]),window.nini.inst.push(["data_name_value",{pattern:/^data\s+(\$[\w]+)\s+(\w+)$/,parse:function(e,t){var n=e[1];return window.nini.vars[n]=e[2],function(){return null}}}]),window.nini.inst.push(["paper_size_xy",{order:-1e4,pattern:/^paper\s+size\s+([1-9]\d{1,3})\s+([1-9]\d{1,3})$/,parse:function(e,t){var r=Number(e[1]),i=Number(e[2]);return window.nini.vars.$pw=r,window.nini.vars.$ph=i,createCornerVars(0,0,r,i),function(e,t){var n={x:r/2,y:i/2};e.trueCentre=n,e.currentCentre=n,e.size={width:r,height:i},e.setAttribute("width",r+"px"),e.setAttribute("height",i+"px")}}}]),window.nini.inst.push(["paper_color_name",{order:-1e4,pattern:/^paper\s+color\s+(#?[\w]{3,32})$/,parse:function(i,e){return function(e,t){var n=i[1],r=e.width,e=e.height;t.fillStyle=n,t.fillRect(0,0,r,e)}}}]),window.nini.inst.push(["pen_size_num",{pattern:/^pen\s+size\s+([1-9]\d{0,3})\s?$/,parse:function(r,e){return function(e,t){var n=Number(r[1]);t.niniSkipDraw=0===n,t.lineWidth=n}}}]),window.nini.inst.push(["pen_color_name",{pattern:/^pen\s+color\s+(#?[\w]{3,32})$/,parse:function(r,e){return function(e,t){var n=r[1];t.strokeStyle=n}}}]),window.nini.inst.push(["brush_color_name",{pattern:/^brush\s+color\s+(#?[\w]{3,32})$/,parse:function(r,e){return function(e,t){var n=r[1];t.fillStyle=n}}}]),window.nini.inst.push(["draw_line_coord_coord",{pattern:/^draw\s+line\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]$/,parse:function(n,r){return function(e,t){draw_line_coord_coord_deg(n,r,e,t)}}}]),window.nini.inst.push(["draw_line_coord_coord_deg",{pattern:/^draw\s+line\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){draw_line_coord_coord_deg(n,r,e,t)}}}]),window.nini.inst.push(["draw_line_coord_length",{pattern:/^draw\s+line\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){draw_line_coord_length_deg(n,r,e,t)}}}]),window.nini.inst.push(["draw_line_coord_length_deg",{pattern:/^draw\s+line\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){draw_line_coord_length_deg(n,r,e,t)}}}]),window.nini.inst.push(["draw_box_coord_width_height",{pattern:/^draw\s+box\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(\d{1,4})\s+(\d{1,4})$/,parse:function(n,r){return function(e,t){create_rect_coord_width_height_deg(n,r,e,t,!1)}}}]),window.nini.inst.push(["draw_box_coord_width_height_deg",{pattern:/^draw\s+box\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(\d{1,4})\s+(\d{1,4})\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_rect_coord_width_height_deg(n,r,e,t,!1)}}}]),window.nini.inst.push(["paint_box_coord_width_height",{pattern:/^paint\s+box\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(\d{1,4})\s+(\d{1,4})$/,parse:function(n,r){return function(e,t){create_rect_coord_width_height_deg(n,r,e,t,!0)}}}]),window.nini.inst.push(["paint_box_coord_width_height_deg",{pattern:/^paint\s+box\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(\d{1,4})\s+(\d{1,4})\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_rect_coord_width_height_deg(n,r,e,t,!0)}}}]),window.nini.inst.push(["draw_circle_coord_radius",{pattern:/^draw\s+circle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(\d{1,4})$/,parse:function(n,r){return function(e,t){create_circle_coord_radius(n,r,e,t,!1)}}}]),window.nini.inst.push(["paint_circle_coord_radius",{pattern:/^paint\s+circle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(\d{1,4})$/,parse:function(n,r){return function(e,t){create_circle_coord_radius(n,r,e,t,!0)}}}]),window.nini.inst.push(["draw_arc_coord_radlist_anglist",{pattern:/^draw\s+arc\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]$/,parse:function(n,r){return function(e,t){create_arc_coord_radius_angles(n,r,e,t,!1)}}}]),window.nini.inst.push(["draw_arc_coord_radlist_anglist_deg",{pattern:/^draw\s+arc\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_arc_coord_radius_angles(n,r,e,t,!1)}}}]),window.nini.inst.push(["paint_arc_coord_radlist_anglist",{pattern:/^paint\s+arc\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]$/,parse:function(n,r){return function(e,t){create_arc_coord_radius_angles(n,r,e,t,!0)}}}]),window.nini.inst.push(["paint_arc_coord_radlist_anglist_deg",{pattern:/^paint\s+arc\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_arc_coord_radius_angles(n,r,e,t,!0)}}}]),window.nini.inst.push(["draw_triangle_coord_base_height",{pattern:/^draw\s+triangle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_triangle_coord_base_height_deg(n,r,e,t,!1)}}}]),window.nini.inst.push(["draw_triangle_coord_base_height_deg",{pattern:/^draw\s+triangle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})\s+(-?\d{1,4})\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_triangle_coord_base_height_deg(n,r,e,t,!1)}}}]),window.nini.inst.push(["draw_triangle_coord_coord_coord",{pattern:/^draw\s+triangle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]$/,parse:function(n,r){return function(e,t){create_triangle_coord_coord_coord_deg(n,r,e,t,!1)}}}]),window.nini.inst.push(["draw_triangle_coord_coord_coord_deg",{pattern:/^draw\s+triangle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_triangle_coord_coord_coord_deg(n,r,e,t,!1)}}}]),window.nini.inst.push(["paint_triangle_coord_base_height",{pattern:/^paint\s+triangle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_triangle_coord_base_height_deg(n,r,e,t,!0)}}}]),window.nini.inst.push(["paint_triangle_coord_base_height_deg",{pattern:/^paint\s+triangle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})\s+(-?\d{1,4})\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_triangle_coord_base_height_deg(n,r,e,t,!0)}}}]),window.nini.inst.push(["paint_triangle_coord_coord_coord",{pattern:/^paint\s+triangle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]$/,parse:function(n,r){return function(e,t){create_triangle_coord_coord_coord_deg(n,r,e,t,!0)}}}]),window.nini.inst.push(["paint_triangle_coord_coord_coord_deg",{pattern:/^paint\s+triangle\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+\[(-?\d{1,4})\s*,\s*(-?\d{1,4})\]\s+(-?\d{1,4})$/,parse:function(n,r){return function(e,t){create_triangle_coord_coord_coord_deg(n,r,e,t,!0)}}}]),window.nini.inst.push(["sign_color_text",{pattern:/^sign (#?[\w]{3,32})\s+(.+)$/,parse:function(o,e){return function(e,t){var n=o[1],r=o[2],i=e.getAttribute("width").split("px")[0],e=e.getAttribute("height").split("px")[0];t.beginPath(),t.font="normal 14px Arial",t.textAlign="end",t.textBaseline="alphabetic",t.fillStyle=n,t.fillText(r,i-8,e-8),t.closePath()}}}]),Object.keys||(Object.keys=(()=>{var i=Object.prototype.hasOwnProperty,o=!{toString:null}.propertyIsEnumerable("toString"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=a.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var t,n=[];for(t in e)i.call(e,t)&&n.push(t);if(o)for(var r=0;r<d;r++)i.call(e,a[r])&&n.push(a[r]);return n}})()),window.nini.app=(()=>{window.tempStorage.loadData(document.cookie);var t,n,r,i,o={theme:"gml",sidebarLeftWidthOpened:300,sidebarLeftWidthClosed:40,sidebarBottomHeightOpened:300,sidebarBottomHeightClosed:30},a={},d=$("html"),s=$("layout-table"),c=$("left-sidebar"),l=$("left-sidebar-table"),e=$("close-left-sidebar-btn"),u=$("open-left-sidebar-btn"),p=$("closed-left-sidebar-toolbar"),h=$("canvas-scroll-wrapper"),w=$("paper1"),g=$("bottom-sidebar"),_=$("closed-bottom-sidebar-toolbar"),f=$("open-bottom-sidebar-btn"),b=$("docs-about-btn");function m(){var e,t;r=Math.round(h.clientWidth/4*3),i=Math.round(h.clientHeight/4*3),e=w.height>h.clientHeight?20:(h.clientHeight-w.height)/2,t=w.width>h.clientWidth?20:(h.clientWidth-w.width)/2,w.style.top=e+"px",w.style.left=t+"px"}function v(){t=d.clientWidth,n=d.clientHeight,s.style.width=t+"px",s.style.height=n+"px",0<!Number(g.getAttribute("height"))&&"closed"!==a.sidebarBottom&&(e=o.sidebarBottomHeightOpened+"px",g.style.height=e,g.setAttribute("height",e)),m();var e=g.clientWidth-50+"px";g.style.width=e,g.setAttribute("width",e)}function y(){var e=o.sidebarLeftWidthOpened+"px";l.style.display="table",c.style.width=e,c.setAttribute("width",e),a.leftSidebar="opened",p.style.display="none",m()}function x(){var e=o.sidebarBottomHeightOpened+"px";g.style.height=e,_.style.display="none",a.sidebarBottom="opened",window.nini.editor.openBottomSidebar(),m()}function N(e){if(!window.nini.compiler)throw new Error("no compiler");void 0!==e&&(window.nini.compiler.reset(),""===e&&"index"!==window.nini.editorEnv.mode&&null!==window.nini.editorEnv.mode&&C(0,0),window.tempStorage.setValue("code",e),window.nini.compiler.compile(e),window.nini.canvas.render("paper1",window.nini.compiler.op),v())}function C(e,t){w.setAttribute("width",e+"px"),w.setAttribute("height",t+"px")}function k(e,t){createPopUp(e,t,{width:800,height:500,left:300,top:200})}return window.addEventListener("resize",v,!0),e.addEventListener("click",function(){var e=o.sidebarLeftWidthClosed+"px";l.style.display="none",c.style.width=e,c.setAttribute("width",e),a.leftSidebar="closed",p.style.display="inline-block",m()}),u.addEventListener("click",y),f.addEventListener("click",x),b.addEventListener("click",function(){k("./docs/pages/about.html","About Nini")}),d.addClass("theme-"+o.theme),y(),v(),e=o.sidebarBottomHeightOpened+"px",g.style.height=e,g.setAttribute("height",e),0!==Number(w.width)&&0!==Number(w.height)||C(r,i),N(window.tempStorage.getValue("code")||""),{layoutDefaults:o,compilerRun:N,closeSidebarBottom:function(){var e=o.sidebarBottomHeightClosed+"px";g.style.height=e,_.style.display="block",a.sidebarBottom="closed",m()},openSidebarBottom:x,toggleGrid:function(){window.nini.canvas.grid.display=!window.nini.canvas.grid.display,N(getCode())},ideClear:function(){window.nini.canvas.reset(),C(r,i);var e=["paper size "+r+" "+i,"paper color white"].join("\n");window.tempStorage.setValue("code",e),window.nini.canvas.grid.display=!1,N(e),v()}}})(),window.nini.editor=(()=>{for(var t,e,n="index",r=(window.opener?(t=window.opener.parent,n="pop-up"):t=window.parent,t.nini.app),i=0;i<t.frames.length;i++){var o=t.frames[i];if("code-editor-iframe"===o.name){e=o,n="iframe";break}}!window.opener&&e||(e=window),window.nini.editorEnv.mode=n,window.nini.editorEnv.parent=t,window.nini.editorEnv.windowRef=e,window.nini.editorEnv.app=r;var a,d=$("html"),s=$("body"),c=$("editor-layout-table"),l=$("run-btn"),u=$("clear-btn"),p=$("pop-up-editor"),h=$("toggle-grid-checkbox"),w=$("save-code"),g=$("load-code"),_=$("load-code-file-input"),f=$("close-bottom-sidebar-btn"),b=$("code-editor"),m=$("editor-scroll-wrapper"),v=$("loc-bar"),y=$("code-editor");function x(){a=("pop-up"===n||"iframe"===n?(d.clientWidth,d):(c.clientWidth,c)).clientHeight,"pop-up"!==n&&"iframe"!==n||(m.style.height=a-50+"px")}e.addEventListener("resize",x,!0),l.addEventListener("click",k),u.addEventListener("click",function(){r.ideClear(),window.nini.editor.init()}),p.addEventListener("click",function(){var e;null===window.origin||"file://"===window.document.location.origin?alert("Pop-up editor cannot be used when opened locally, due to CORS limitations."):(e=window.open("./editor/editor.html","Editor","left=500,top=200,width=800,height=400,status=yes,toolbar=no,menubar=no"))?(P(),e.onload=function(){this.onbeforeunload=r.openSidebarBottom}):alert("Pop-up editor window was blocked by your browser.")}),h.addEventListener("change",function(){t.toggleGrid()}),w.addEventListener("click",function(){var e=prompt("File name:");{var t;e&&(t=b.value,createDownload(e+".txt",t))}}),g.addEventListener("click",function(){_.dispatchEvent(new MouseEvent("click",{bubbles:!0}))}),_.addEventListener("change",function(){var e=_.files[0];{var n;e.type.match(/text.*/)?((n=new FileReader).onload=function(e){var t=n.result;b.value=t,k()},n.readAsText(e)):alert("File not supported!")}}),f.addEventListener("click",P),s.addEventListener("keydown",function(e){e.defaultPrevented||(void 0!==e.key?"Enter"===e.key&&e.ctrlKey&&k():void 0!==e.keyIdentifier?"Enter"===e.keyIdentifier&&e.ctrlKey&&k():void 0!==e.keyCode&&13===e.keyCode&&e.ctrlKey&&k())});for(var N=1;N<=999;N++){var C=document.createElement("span");C.append(N),v.append(C),v.append(document.createElement("br"))}function k(){var e=b.value;t.setCode(e)}function P(){c.style.display="none",r.closeSidebarBottom()}function S(){"index"!==n&&d.addClass("theme-"+r.layoutDefaults.theme),m.style.height=r.layoutDefaults.sidebarBottomHeightOpened-50+"px",window.opener&&(p.style.display="none",f.style.display="none");var e=t.getCode();b.value=e,h.checked=t.displayGridValue(),x()}return l=v.clientHeight,y.style.height=l+"px",S(),{mode:n,openBottomSidebar:function(){c.style.display="table",b.value=t.getCode(),S()},init:S}})();