void 0===window.nini&&(window.nini={}),window.nini.editorEnv={mode:null,parent:null,windowRef:null,app:null},Object.keys||(Object.keys=(()=>{var i=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),d=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=d.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var t,n=[];for(t in e)i.call(e,t)&&n.push(t);if(r)for(var o=0;o<a;o++)i.call(e,d[o])&&n.push(d[o]);return n}})());{function $(e){e=document.getElementById(e);return e.addClass=addClass,e}function addClass(e){this.classList.add(e)}}function negateNum(e){return 0===e?0:e<0?Math.abs(e):-1*Math.abs(e)}function calcTwoPointDistance(e,t,n,o){e-=n,n=t-o;return Math.sqrt(e*e+n*n)}function degreesToRadians(e){return e*(Math.PI/180)}function radiansToDegrees(e){return e*(180/Math.PI)}function createDownload(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function createPopUp(e,t,n){n="left="+n.left+",top="+n.top+",width="+n.width+",height="+n.height+",status=yes,toolbar=no,menubar=no";window.open(e,t,n)||alert("Pop-up window was blocked by your browser.")}void 0===window.tempStorage&&(window.tempStorage=(()=>{var i={store:{},loadData:function(e){for(var t,n=decodeURIComponent(e).split(";"),o=0;o<n.length;o++)t=n[o].split("="),i.store[t[0]]=t[1]},setValue:function(e,t){document.cookie=e+"="+encodeURIComponent(t)+";",i.store[e]=t},getValue:function(e){if(void 0!==i.store[e])return i.store[e]}};return i})()),window.nini.editor=(()=>{for(var t,e,n="index",o=(window.opener?(t=window.opener.parent,n="pop-up"):t=window.parent,t.nini.app),i=0;i<t.frames.length;i++){var r=t.frames[i];if("code-editor-iframe"===r.name){e=r,n="iframe";break}}!window.opener&&e||(e=window),window.nini.editorEnv.mode=n,window.nini.editorEnv.parent=t,window.nini.editorEnv.windowRef=e,window.nini.editorEnv.app=o;var d,a=$("html"),l=$("body"),c=$("editor-layout-table"),s=$("run-btn"),u=$("clear-btn"),p=$("pop-up-editor"),w=$("toggle-grid-checkbox"),f=$("save-code"),v=$("load-code"),y=$("load-code-file-input"),h=$("close-bottom-sidebar-btn"),m=$("code-editor"),b=$("editor-scroll-wrapper"),g=$("loc-bar"),E=$("code-editor");function k(){d=("pop-up"===n||"iframe"===n?(a.clientWidth,a):(c.clientWidth,c)).clientHeight,"pop-up"!==n&&"iframe"!==n||(b.style.height=d-50+"px")}e.addEventListener("resize",k,!0),s.addEventListener("click",P),u.addEventListener("click",function(){o.ideClear(),window.nini.editor.init()}),p.addEventListener("click",function(){var e;null===window.origin||"file://"===window.document.location.origin?alert("Pop-up editor cannot be used when opened locally, due to CORS limitations."):(e=window.open("./editor/editor.html","Editor","left=500,top=200,width=800,height=400,status=yes,toolbar=no,menubar=no"))?(x(),e.onload=function(){this.onbeforeunload=o.openSidebarBottom}):alert("Pop-up editor window was blocked by your browser.")}),w.addEventListener("change",function(){t.toggleGrid()}),f.addEventListener("click",function(){var e=prompt("File name:");{var t;e&&(t=m.value,createDownload(e+".txt",t))}}),v.addEventListener("click",function(){y.dispatchEvent(new MouseEvent("click",{bubbles:!0}))}),y.addEventListener("change",function(){var e=y.files[0];{var n;e.type.match(/text.*/)?((n=new FileReader).onload=function(e){var t=n.result;m.value=t,P()},n.readAsText(e)):alert("File not supported!")}}),h.addEventListener("click",x),l.addEventListener("keydown",function(e){e.defaultPrevented||(void 0!==e.key?"Enter"===e.key&&e.ctrlKey&&P():void 0!==e.keyIdentifier?"Enter"===e.keyIdentifier&&e.ctrlKey&&P():void 0!==e.keyCode&&13===e.keyCode&&e.ctrlKey&&P())});for(var C=1;C<=999;C++){var L=document.createElement("span");L.append(C),g.append(L),g.append(document.createElement("br"))}function P(){var e=m.value;t.setCode(e)}function x(){c.style.display="none",o.closeSidebarBottom()}function I(){"index"!==n&&a.addClass("theme-"+o.layoutDefaults.theme),b.style.height=o.layoutDefaults.sidebarBottomHeightOpened-50+"px",window.opener&&(p.style.display="none",h.style.display="none");var e=t.getCode();m.value=e,w.checked=t.displayGridValue(),k()}return s=g.clientHeight,E.style.height=s+"px",I(),{mode:n,openBottomSidebar:function(){c.style.display="table",m.value=t.getCode(),I()},init:I}})();